"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3848],{3023:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>d});var a=r(3696);const t={},i=a.createContext(t);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),a.createElement(i.Provider,{value:n},e.children)}},7827:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>s,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"tutorial-extras/orm-and-model","title":"Orm: Object Regional Mapping and Models","description":"The aim is to make accessing database easier and more friendly using objects.","source":"@site/docs/tutorial-extras/orm-and-model.md","sourceDirName":"tutorial-extras","slug":"/tutorial-extras/orm-and-model","permalink":"/pashmak/docs/tutorial-extras/orm-and-model","draft":false,"unlisted":false,"editUrl":"https://github.com/devbro1/pashmak/blob/master/docs/docs/tutorial-extras/orm-and-model.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"File Storage","permalink":"/pashmak/docs/tutorial-extras/file-storage"}}');var t=r(2540),i=r(3023);const s={sidebar_position:2},d="Orm: Object Regional Mapping and Models",l={},o=[{value:"primary key",id:"primary-key",level:2},{value:"guarded",id:"guarded",level:2},{value:"toJson()",id:"tojson",level:2},{value:"save()",id:"save",level:2},{value:"delete()",id:"delete",level:2},{value:"table name",id:"table-name",level:2},{value:"creating a new model",id:"creating-a-new-model",level:2},{value:"refresh()",id:"refresh",level:2},{value:"find() / findByPrimaryKey()",id:"find--findbyprimarykey",level:2},{value:"findOrFail()",id:"findorfail",level:2},{value:"findOne()",id:"findone",level:2},{value:"getQuery()",id:"getquery",level:2},{value:"fill()",id:"fill",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"orm-object-regional-mapping-and-models",children:"Orm: Object Regional Mapping and Models"})}),"\n",(0,t.jsx)(n.p,{children:"The aim is to make accessing database easier and more friendly using objects."}),"\n",(0,t.jsx)(n.p,{children:"to create a new model:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",children:'import { BaseModel, Attribute } from "neko-orm/src";\n\nexport class User extends BaseModel {\n  protected guarded: string[] = ["password"];\n\n  @Attribute({ primaryKey: true, incrementingPrimaryKey: true })\n  declare id: number;\n\n  @Attribute()\n  declare username: string;\n\n  @Attribute()\n  active: boolean = true;\n\n  @Attribute()\n  declare password: string;\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"every attribute that comes from database must get a @Attribute() decorator. It will tell the model what needs to be loaded or saved to database."}),"\n",(0,t.jsx)(n.h2,{id:"primary-key",children:"primary key"}),"\n",(0,t.jsxs)(n.p,{children:["every model will need a unique identified that you mark using ",(0,t.jsx)(n.code,{children:"primaryKey:true"}),". If the value of your primary key is auto-calculated in the database during insert, then ",(0,t.jsx)(n.code,{children:"incrementingPrimaryKey: true"})," will let model know to get the newly generated id after create."]}),"\n",(0,t.jsx)(n.h2,{id:"guarded",children:"guarded"}),"\n",(0,t.jsx)(n.p,{children:"if you want to mark a attribute as sensetive, you can use guarded to tell the model to not include it when we call toJson();"}),"\n",(0,t.jsx)(n.h2,{id:"tojson",children:"toJson()"}),"\n",(0,t.jsxs)(n.p,{children:["you can convert a model object to a json using ",(0,t.jsx)(n.code,{children:"toJson()"})," to send or save clean data."]}),"\n",(0,t.jsx)(n.h2,{id:"save",children:"save()"}),"\n",(0,t.jsx)(n.p,{children:"to save your data to database, if it is an object that was retrieved from database, then it will update database."}),"\n",(0,t.jsx)(n.h2,{id:"delete",children:"delete()"}),"\n",(0,t.jsx)(n.p,{children:"to delete the model from database. data still reside in the object."}),"\n",(0,t.jsx)(n.h2,{id:"table-name",children:"table name"}),"\n",(0,t.jsx)(n.p,{children:"table name is auto calculated as plural of the model name. so Country model will look rows from countries table."}),"\n",(0,t.jsx)(n.p,{children:"if you want to override the table name:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"protected tableName: string = 'mars_countries';\n"})}),"\n",(0,t.jsx)(n.h2,{id:"creating-a-new-model",children:"creating a new model"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"let user = new User();\nuser.fill({ username: 'meowadmin' });\n// or\nlet user = new User({ username: 'meowadmin' });\n"})}),"\n",(0,t.jsx)(n.p,{children:"only parameters marked with @attribute will be filled."}),"\n",(0,t.jsx)(n.h2,{id:"refresh",children:"refresh()"}),"\n",(0,t.jsx)(n.p,{children:"sometimes you need to reload data from database. you can do this by"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'console.log(user.username); // meow\nuser.username = "newusername";\nconsole.log(user.username); // newusername\nawait user.refresh();\nconsole.log(user.username); // meow\n'})}),"\n",(0,t.jsx)(n.h2,{id:"find--findbyprimarykey",children:"find() / findByPrimaryKey()"}),"\n",(0,t.jsxs)(n.p,{children:["assuming you are using ",(0,t.jsx)(n.code,{children:"id"})," as your primary key, you can find objects by id"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await User.find(123);\nawait User.findByPrimaryKey(123);\n"})}),"\n",(0,t.jsx)(n.p,{children:"if find fails, it will return undefined"}),"\n",(0,t.jsx)(n.h2,{id:"findorfail",children:"findOrFail()"}),"\n",(0,t.jsxs)(n.p,{children:["same as ",(0,t.jsx)(n.code,{children:"find()"})," but will throw an error on failure"]}),"\n",(0,t.jsx)(n.h2,{id:"findone",children:"findOne()"}),"\n",(0,t.jsx)(n.p,{children:"it will return the first object that matches the search matches you provide."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'await USer.findOne({ username: "meowadmin" });\n'})}),"\n",(0,t.jsx)(n.p,{children:"note: the search parameters need to be exact match. they also can be anything defined in database but not in your model."}),"\n",(0,t.jsx)(n.h2,{id:"getquery",children:"getQuery()"}),"\n",(0,t.jsx)(n.p,{children:"returns a query object with table predefined"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"await User.getQuery();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"fill",children:"fill()"}),"\n",(0,t.jsx)(n.p,{children:"to mass field parameters in a object"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'user.fill({ email: "meow@devbro.com" });\n'})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);